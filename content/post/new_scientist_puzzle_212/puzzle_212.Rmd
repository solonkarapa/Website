---
title: "# 212 Puzzle from the New Scientist"
author: Me
date: '2023-02-08'
slug: puzzle212
categories:
  - puzzle
tags: [puzzle]
subtitle: ''
summary: ''
authors: []
lastmod: '2023-03-30T14:27:06Z'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: yes
projects: []
draft: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

[Puzzle #212](https://www.newscientist.com/article/mg25734291-300-puzzle-212-can-you-work-out-how-sams-mum-can-unmute-her-television/) from the New Scientist is: 

> “Why isn’t the sound working?”, Mum muttered as she hit the mute key on the remote control.

> “You’ve probably got the wrong remote, Mum”, Sam said. “Remember, it’s the long, thin one for the television, the wide one for the set-top box and the little one for the speakers. Which one did you mute?”

> “I can’t remember”, said Mum, as she got her thinking cap on to try to fix things.

> To get sound, all three remotes have to be unmuted. Mum came up with the most efficient system for cycling through the possible combinations of muting and unmuting, and got to work.

> What is the maximum number of presses needed if she wanted to be sure of getting the sound back?

## Solution

Each remote can be in one of two states {mute or unmute}. There are three remotes, so in total there are $2^3=8$ possible states. 

An example of a state is {mute, mute, unmute}. The desired state is {unmute, unmute, unmute}. 

We’ll start by finding an efficient system for cycling through the possible combinations of states. 

The system goes as follows:

1) choose a remote and press the mute/unmute button. 
    a) If no sound, repeat step 1, but this time choosing a different remote. 
        - The worst-case scenario requires 3 presses. We may need to cycle through 1, 2 or all 3 remotes. 

2) After testing all three remotes in step 1 and provided there is no sound we start over again but now choosing two remotes together and pressing the mute/unmute buttons. 
    a) If no sound, repeat step 2, but this time choosing the other remotes.
        - The worst-case scenario this requires 3 presses. That is we can choose, to press remote 1 and remote 2, remote 1 and remote 3, and, remote 1 and remote 3. In total 3 choices. 

3) For last step, we can press all three remotes simultaneously. 
   - This requires 1 press.

So the maximum number of presses is 7: 3 at step 1, 3 at step 2 and 1 at step 3. Let's try to code this system to verify our answer. 

## Code 


```{r}
library(dplyr)
library(combinat)
library(purrr)

# create a vector to store the status of each device (muted = 1, unmuted = 0)
devices <- c(1, 0, 1) # start from any state

# create a function to check if all devices are unmuted
check_sound <- function(devices) {
    sum(devices) == 3
}
```

```{r}

counter <- function(initial_state){
   
   if(length(initial_state) != 3){
      stop("The function works for only 3 states at the moment.")
   }
   
   devices <- initial_state 

   count <- 0 # initialize a counter for the number of presses

    # first check if all unmuted
    if (check_sound(devices)) {
       out <- count
       }
    
    # check if changing all fixed the problem - this is step 3 above
    devices[c(1, 2, 3)] <- 1 - devices[c(1, 2, 3)]
    count <- count + 1 # add 1 count
    
    if (check_sound(devices)) {
        out <- count
       } else {
          devices[c(1, 2, 3)] <- 1 - devices[c(1, 2, 3)] # revert to initial state
          }

     # create indices to loop through
      g <- expand.grid(1:3, 1:3) %>% mutate(Var3 = (Var1 == Var2)) %>% arrange(desc(Var3))
   
    for (i in 1:nrow(g)) {
       # checks  
       indices <- g[i,]
       devices[c(indices$Var1, indices$Var2)] <- 1 - devices[c(indices$Var1, indices$Var2)]
    
      if (check_sound(devices)) {
          out <- count
         } else {
            count = count + 1
            devices[c(indices$Var1, indices$Var2)] <- 1 - devices[c(indices$Var1, indices$Var2)]
            }
    }
      
      return(data.frame(initial_state = paste(initial_state, collapse = " "), count = out))
}
```

```{r}
states <- list(c(0, 0, 0), c(1, 1, 1), 
               c(1, 0, 0), c(0, 1, 0), c(0, 0, 1),
               c(1, 1, 0), c(1, 0, 1), c(0, 1, 1)) 

res <- map_dfr(states, counter)

ggplot(res) +
   geom_point(aes(x = initial_state, y = count)) +
   geom_text(aes(x = initial_state, y = count + 0.5, label = count)) +
   labs(x = "Initial State", y = "Number of presses") +
   theme_linedraw(12)


```

