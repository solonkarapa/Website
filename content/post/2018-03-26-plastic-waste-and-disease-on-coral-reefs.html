---
title: Plastic waste and disease on coral reefs
author: ''
date: '2018-03-26'
slug: plastic-waste-and-disease-on-coral-reefs
categories: []
tags: []
header:
  caption: ''
  image: ''
draft: true
---



<p>Recently, I came across this very interesting article about how plastic waste is associated with disease on coral reefs. The main colcusions are</p>
<ul>
<li>contact with plastic increase the probability of disease,<br />
</li>
<li>the stucture of the reefs is assocaited with the probabiltiy of being in contact with plastic with more complex ones being more likely to be affected by plastic,<br />
</li>
<li>the plastic levels correspond to estimates of mismanaged plastic waste into the ocean.</li>
</ul>
<p>Overall, this study provides evidence how plastic waste negatively affects the coral reefs, making them more susceptible to diseases. The authors made availble both the datasets they used and the code (clerluy documented), so it’s an excellent example of reproducilbe research. The methods sections is straightforward ot unsdesstand except in a couple of points.</p>
<p>My first comment is where the authors estimated the plastic waste entering the ocean. To do this they fitted a generalized linear mixed-effects models (GLMMs) relating the number of plastic debris items surveyed on coral reefs with 7 variables published in a previously (ref). They first created draftsman plots in order to identify variables with correlations &gt; 0.7. I assume the purpose of this was to avoid estimation problems due to high collinearity. In the second step, they used the remaining three variables</p>
<ul>
<li>coastal population size in 2010 (<span class="math inline">\(x_1\)</span>),</li>
<li>25% of coastal mismanaged waste entering the ocean in 2010 (<span class="math inline">\(x_2\)</span>) and</li>
<li>mismanaged waste per capita in 2010 (<span class="math inline">\(x_3\)</span>)</li>
</ul>
<p>as fixed effect predictors in the GLMMs using a negative binomial distribution with a log link, with region and year set as a random factor (this corresponds to a random intercept varying among year and region within year). Their models looked like</p>
<p><span class="math display">\[log(Y_{ijk}) =  \beta_0 + \beta_1x_1 + b_i + b_{j(i)}\]</span></p>
<p><span class="math display">\[log(Y_{ijk}) =  \beta_0 + \beta_1x_2 + b_i + b_{j(i)}\]</span> <span class="math display">\[log(Y_{ijk}) =  \beta_0 + \beta_1x_3 + b_i + b_{j(i)}\]</span></p>
<p>where <span class="math inline">\(Y_{ijk}\)</span> denote the counts of corals with plastic, for year <span class="math inline">\(j\)</span>, of region <span class="math inline">\(i\)</span>. <span class="math inline">\(\beta\)</span>s are the fixed effects. The term <span class="math inline">\(b_i\)</span> captures the variation between years and the term <span class="math inline">\(b_{j(i)}\)</span> captures the variation between regions within a specific year. Finally, they choose the model with the higher AIC.</p>
<p>What I was not able to understand is why they didn’t create a model with all the variables (<span class="math inline">\(x_1, x_2, x_3\)</span>) together? Instead they fitted three different ones. Unfortunalely, the dataset corresponding to this analysis is not provided, so I was not able to perfrom the analysis with all the varaibles included at once.</p>
<p>Secondly, they model the presense of plastic debris (binary) <em>and</em> the presense of disease (binary) among different coral morphological structural complexity assignments (massive, tabular, and branching). Now they use a GLMM with binomial error distribution and logistic link. The morphological assignments were treated as fixed factors and the site as random. The model is<br />
<span class="math display">\[ logit(DebrisPresense_{ik}) =  \sum_j \beta_j x_j + b_i \]</span></p>
<p>where <span class="math inline">\(j_{1:3} = \{massive, tabular, and branching\}\)</span>. The output is given in Figure 4(A) in the paper. The conclusion is that plastic debris is more likely in tabular and braching vs massive reefs. Then, they want to find out the baseline disease levels by structural form so they fit the same model,</p>
<p><span class="math display">\[ logit(Disease Presense_{ik}) =  \sum_j \beta_j x_j + b_i \]</span></p>
<p>only for corals unaffected by plastic waste. The outcome is given in Figure 4(B) in the paper. The second step was to use the same model to estimate the probability of plastic debris disease by structural form for corals affected by plastic waste (Figure 4(D)). The conclusion is the presense of plastic debris increases the likelihood of disease. The next step is to fit again the model for each different level of the structural form (ie. for each <span class="math inline">\(x_j\)</span>). Results in Figure 4(C).</p>
<p>To me it seems they are essentially searching for an interaction between the structural complexity <span class="math inline">\((x_j\)</span>s) and whether or not the the reefs have been in contact with plastic debris. <strong>Efficiency loss</strong>. Something along the lines</p>
<p><span class="math display">\[ logit(Disease Presense_{ik}) =  \sum_j \beta_j x_j*x_4  + b_i\]</span></p>
<p>where <span class="math inline">\(x_4\)</span> is a binary indicator for whether the reefs have been in contacht with plastic debris.</p>
<p>Thirdly, and most imporatntly the authors interpret the coeffcients in an incorrect way. The issue with GLLMs is that the fixed effects have a site-specific interpretation but not a population-average interpretation. Let us now consider the logistic random-intercepts model above. We have that</p>
<p><span class="math display">\[ E[Disease Presense_{ik}|b_i] = \frac{\exp(\sum_j \beta_j x_j + b_i)}{1 + \exp(\sum_j \beta_j x_j + b_i)} \]</span></p>
<p>The above model assumes a logistic evolution of the success probability of each morhology, all curves having different intercepts <span class="math inline">\(\beta0 + bi\)</span>. The average site, i.e., the site with intercept <span class="math inline">\(b_i = 0\)</span>, has success probability given by</p>
<p><span class="math display">\[ E[Disease Presense_{ik}|b_i = 0] = \frac{\exp(\sum_j \beta_j x_j + 0)}{1 + \exp(\sum_j \beta_j x_j + 0)} \]</span></p>
<p>which is what the authors have calcaulated and producted Fig 4. In otehr words, the authors have calcauted the probability for an “average” site. Parameters in the mixed model have a subject-specific interpretation, not a population-averaged one. The problem arises from the fact that, <span class="math inline">\(E[g(Y )] \neq g[E(Y)]\)</span>. The marginal population-average evolution is obtained from averaging over the random effects.</p>
<pre class="r"><code># GLMM PDF, Disease levels by Plastic Debris for Branching -----------------------------
Branch.Disease = glmer(Disease ~ Plastic + (1|Reef_Name),
                       data = Plastic[which(Plastic$Growth2==&#39;Branching&#39;),],
                       family = &#39;binomial&#39;,
                       control = glmerControl(optimizer =&quot;bobyqa&quot;))
# Branch.Disease.Null = glmer(Disease~1+(1|Reef_Name),
#                             data=Plastic[which(Plastic$Growth2==&#39;Branching&#39;),],
#                             family=&#39;binomial&#39;,
#                             control = glmerControl(optimizer =&quot;bobyqa&quot;))
# anova(Branch.Disease, Branch.Disease.Null, test = &#39;lrt&#39;)
# AIC(Branch.Disease, Branch.Disease.Null)
# ModSelBranch = model.sel(Branch.Disease,Branch.Disease.Null)
#write.table(ModSelBranch, &quot;Branch_Comp_ModelTable.csv&quot;, col.names = TRUE, row.names = FALSE, sep = &#39;,&#39;)
# Generate data for the creation of a smooth probability density curve based on model results
Branch = data.frame(Normal = rnorm(100000, mean = -3.6208, sd =.1184),
                    Plastic= rnorm(100000, mean = -3.6208 + 5.8871, sd = sqrt(.1184^2 + .278^2)))
Branch$Normalbt = plogis(Branch$Normal)
Branch$Plasticbt = plogis(Branch$Plastic)
Branch = gather(Branch, Condition, Estimate, Normalbt:Plasticbt)
#Branch$Relative = Branch$Estimate/plogis(-3.6208)
ggplot(aes(x = Estimate*100), data = Branch) + 
   geom_density(aes(y = ..scaled.., fill = Condition)) +
   scale_x_continuous(limits = c(0, 100)) +
   geom_rug(aes(color = Condition), 
            data = Branch[seq(from = 1,to = length(Branch$Estimate), by = 500),])</code></pre>
<p><img src="/post/2018-03-26-plastic-waste-and-disease-on-coral-reefs_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Here is a plot of the empirical Bayes estimates of the random effects. We see the great varaiblity.</p>
<pre class="r"><code>library(merTools)
sim_rfs_Branch.Disease &lt;- REsim(Branch.Disease, n.sims = 200) 
plotREsim(sim_rfs_Branch.Disease)</code></pre>
<p><img src="/post/2018-03-26-plastic-waste-and-disease-on-coral-reefs_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>What the authors are effectivey doing is presenting the results for reef with <span class="math inline">\(b_i = 0\)</span> which corresponds to the red line. Let’s see how figure (above) changes when we take into account more “extreme” reefs. I start with the 0.9 quantile.</p>
<p>This plots still ignores the unceratiy in only takes variation of the fixed coefficients</p>
<p>Differences in levels of baseline coral disease prevalence among regions were analyzed using a GLMM with a binomial error distribution and logistic link. Only corals that were not affected by plastic debris were included to assess if baseline disease levels differed among regions surveyed in AsiaPacific. Regions were treated as fixed factors, with site included as a random effect to remain consistent with the design of the study.</p>
<pre class="r"><code># GLMM, Baseline Disease levels for different growth forms, Asia Pacific --------
Normal.Disease.Growth = glmer(Disease ~ -1 + Growth2+(1|Reef_Name), 
                              data = Plastic[which(Plastic$Plastic==0),], 
                              family = &#39;binomial&#39;, 
                              control = glmerControl(optimizer =&quot;bobyqa&quot;))</code></pre>
<p>The following table corresponds to Figure 4(B) of the publication.</p>
<pre class="r"><code># PDF, Baseline disease levels by growth form -----------------------------
NormalDisease.by.Growth = data.frame(Tabular = rnorm(100000, mean = -3.1332, sd = .1549),
                                   Massive = rnorm(100000, mean = -3.8153, sd = .1095),
                                   Branching = rnorm(100000, mean = -3.5534, sd = .1103))
NormalDisease.by.Growth$Tabularbt = plogis(NormalDisease.by.Growth$Tabular)
NormalDisease.by.Growth$Massivebt = plogis(NormalDisease.by.Growth$Massive)
NormalDisease.by.Growth$Branchingbt = plogis(NormalDisease.by.Growth$Branching)
NormalDisease.by.Growth = gather(NormalDisease.by.Growth, Growth, Estimate, Tabularbt:Branchingbt)
#NormalDisease.by.Growth$Relative=NormalDisease.by.Growth$Estimate/plogis(-3.8153)
ggplot(aes(x=Estimate*100), data = NormalDisease.by.Growth) +
   geom_density(aes(y=..scaled..,fill = Growth)) +
   scale_x_continuous(limits = c(0, 10)) </code></pre>
<p><img src="/post/2018-03-26-plastic-waste-and-disease-on-coral-reefs_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>#+
#   geom_rug(aes(color = Growth), #data=NormalDisease.by.Growth[seq(from=1,to=length(NormalDisease.by.Growth$Estimate),by=500),])</code></pre>
<p>This plots still ignores the uncertainty in …. it only takes into consideration the variation of the fixed coefficients <span class="math inline">\(\beta_j\)</span>.</p>
<p>I simulate random effects from the model and plot them. Points that are distinguishable from zero (i.e. the confidence band based on level does not cross the red line) are highlighted. We see great variation….</p>
<pre class="r"><code>library(merTools)
sim_rfs_Normal.Disease &lt;- REsim(Normal.Disease.Growth, n.sims = 200) 
plotREsim(sim_rfs_Normal.Disease)</code></pre>
<p><img src="/post/2018-03-26-plastic-waste-and-disease-on-coral-reefs_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>What the authors are effectivectly doing in Figure 4(B) (see density plot above) is presenting the results for reef with <span class="math inline">\(b_i = 0\)</span> which corresponds to the red line. Let’s see how figure (above) changes when we take into account more “extreme” reefs. I start with the 0.1 and 0.9 quantiles.</p>
<pre class="r"><code>quantile0.9 &lt;- REquantile(Normal.Disease.Growth, quantile = 0.9, groupFctr = &quot;Reef_Name&quot;)
which(sim_rfs_Normal.Disease$groupID == quantile0.9)</code></pre>
<pre><code>## [1] 44</code></pre>
<pre class="r"><code>quantile0.1 &lt;- REquantile(Normal.Disease.Growth, quantile = 0.1, groupFctr = &quot;Reef_Name&quot;)
which(sim_rfs_Normal.Disease$groupID == quantile0.1)</code></pre>
<pre><code>## [1] 22</code></pre>
<pre class="r"><code>NormalDisease.by.Growth_quantile0.9 = data.frame(Tabular = rnorm(100000, mean=-3.1332 + 1.495773,sd=.1549),
                                     Massive = rnorm(100000, mean=-3.8153 + 1.495773, sd = .1095),
                                     Branching=rnorm(100000, mean=-3.5534 + 1.495773, sd = .1103))
NormalDisease.by.Growth_quantile0.9$Tabularbt = plogis(NormalDisease.by.Growth_quantile0.9$Tabular)
NormalDisease.by.Growth_quantile0.9$Massivebt = plogis(NormalDisease.by.Growth_quantile0.9$Massive)
NormalDisease.by.Growth_quantile0.9$Branchingbt = plogis(NormalDisease.by.Growth_quantile0.9$Branching)
NormalDisease.by.Growth_quantile0.9 = gather(NormalDisease.by.Growth_quantile0.9, Growth, Estimate, Tabularbt:Branchingbt)
NormalDisease.by.Growth_quantile0.1 = data.frame(Tabular = rnorm(100000, mean=-3.1332 - 1.689569,sd=.1549),
                                                 Massive = rnorm(100000, mean=-3.8153 - 1.689569, sd = .1095),
                                                 Branching=rnorm(100000, mean=-3.5534 - 1.689569, sd = .1103))

NormalDisease.by.Growth_quantile0.1$Tabularbt = plogis(NormalDisease.by.Growth_quantile0.1$Tabular)
NormalDisease.by.Growth_quantile0.1$Massivebt = plogis(NormalDisease.by.Growth_quantile0.1$Massive)
NormalDisease.by.Growth_quantile0.1$Branchingbt = plogis(NormalDisease.by.Growth_quantile0.1$Branching)
NormalDisease.by.Growth_quantile0.1 = gather(NormalDisease.by.Growth_quantile0.1, Growth, Estimate, Tabularbt:Branchingbt)

NormalDisease.by.Growth$ID = &quot;average&quot;
NormalDisease.by.Growth_quantile0.1$ID = &quot;0.1quantile&quot;
NormalDisease.by.Growth_quantile0.9$ID = &quot;0.9quantile&quot;

overall &lt;- rbind(NormalDisease.by.Growth, NormalDisease.by.Growth_quantile0.1, NormalDisease.by.Growth_quantile0.9)
ggplot(aes(x = Estimate*100, col = ID), data = overall) +
   geom_density(aes(y = ..scaled.., fill = Growth), alpha = 0.9, size = 1.3) +
   scale_fill_brewer(palette = &quot;Spectral&quot;) + 
   #scale_fill_manual(values = c(&quot;#D55E00&quot;, &quot;#009E73&quot;, &quot;#0072B2&quot;)) + 
   scale_color_manual(values = c(&quot;#000000&quot;, &quot;dodgerblue&quot;, &quot;darkmagenta&quot;)) +
   scale_x_continuous(limits = c(0, 10)) + 
   ylab(&quot;&quot;)</code></pre>
<pre><code>## Warning: Removed 202847 rows containing non-finite values (stat_density).</code></pre>
<p><img src="/post/2018-03-26-plastic-waste-and-disease-on-coral-reefs_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>It is evident both the center and the variability of the distributinos change depending whether we look an “average” coral reef (purple line), a reef towards the upper extreme (blue line) or the lower extreme (black line).</p>
<p>Conclusion the increase in disease likelihood with plastic debris depends also on the inherit characteristics of the reefs in additon to the morhology. For example, the likelihood of disease is between a braching reef at the lower extreme ( interprt the random effect) is and a tabular reef at the upper extreme (interprt the random effect) are very close.</p>
<p>In order to generate a proper prediction interval, a prediction must account for three sources of uncertainty in mixed models:</p>
<p>the residual (observation-level) variance, the uncertainty in the fixed coefficients, and the uncertainty in the variance parameters for the grouping factors.</p>
<p>FINAL ANALYSIS 1. TAKE Normal.Disease.Growth 2. REPRODUCE PLOTS 4(B) 3. PLOT RANDOM EFFECT ESTIMATES - MENTION UNCERTAINY 4. REDO PLOT 2 WITH 0.1 AND 0.9 QUANTILES 5. FORM PREDICTIVE INTERVALS</p>
