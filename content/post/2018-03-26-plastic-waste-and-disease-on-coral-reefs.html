---
title: Plastic waste and disease on coral reefs
author: ''
date: '2018-03-26'
slug: plastic-waste-and-disease-on-coral-reefs
categories: []
tags: []
header:
  caption: ''
  image: ''
  bookdown::html_document2: default
bibliography: bibliopost.bib
link-citations: yes
draft: true
---



<p>Recently, I came across this very interesting article publised in <a href="http://science.sciencemag.org/content/359/6374/460.long">Science</a> about how plastic waste is associated with disease on coral reefs <span class="citation">(J. B. Lamb et al. <a href="#ref-lamb2018plastic">2018</a>)</span>. The main conclusions are</p>
<ol style="list-style-type: decimal">
<li>contact with plastic increases the probability of disease,<br />
</li>
<li>the structure of the reefs is associated with the probability of being in contact with plastic with more complex ones being more likely to be affected by plastic,<br />
</li>
<li>the plastic levels correspond to estimates of mismanaged plastic waste into the ocean.</li>
</ol>
<p>Overall, this study provides evidence how plastic waste negatively affects coral reefs, making them more susceptible to diseases. The authors made available both the datasets they used and the code <span class="citation">(both can be downloaded from J. Lamb et al. <a href="#ref-dryad_mp480">2018</a>)</span> so it’s an excellent example of reproducible research. The methods sections is straightforward to follow (see <a href="http://science.sciencemag.org/content/suppl/2018/01/24/359.6374.460.DC1?_ga=2.198123375.1394041835.1523546630-1357771364.1523546630">Supplementary Materials</a>). My comment is about the 2nd point above, and more specifically the methodology behind Figure 4 in the paper. The issue is the authors interpret the coefficients in an misleading way.</p>
<p>They model the disease prevalence (binary) among coral reefs with different morphology. The structural morphology assignments were massive, tabular, and branching. They use a GLMM with binomial error distribution and logistic link. The morphological assignments were treated as fixed factors and the site as random. The model is</p>
<p><span class="math display">\[ logit(Disease Presense_{ik}) =  \sum_j \beta_j x_j + b_i \]</span></p>
<p>where <span class="math inline">\(j_{1:3} = \{massive, tabular, and branching\}\)</span> and <span class="math inline">\(b_i\)</span> are the reef-specific intercepts. Such a <span class="math inline">\(b_i\)</span> represents the deviation of the intercept of a specific reef from the average intercept in the group to which that reef belongs, i.e deviation from <span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\beta_2\)</span> or <span class="math inline">\(\beta_3\)</span>. The model is fitted only for reefs unaffected by plastic waste. The outcome is given in Figure 4(B) in the paper. The conclusion is the disease risk increases from massive to bracnhing and tabular reefs when not in contact with plastic debris (Figure 4(B) and table S13).</p>
<p>The issue with this figure is the authors interpret the coefficients in an misleading way. In GLLMs is the fixed effects have a site-specific interpretation but not a population-average interpretation. Let us now consider the logistic random-intercepts model above. We have that</p>
<p><span class="math display">\[ E[Disease Presense_{ik}|b_i] = \frac{\exp(\sum_j \beta_j x_j + b_i)}{1 + \exp(\sum_j \beta_j x_j + b_i)} \]</span> where <span class="math inline">\(E[.]\)</span> is the expectation operator. The above model assumes a logistic evolution of the success probability of each morphology, all curves having different intercepts <span class="math inline">\(\beta_0 + bi\)</span>. The average site, i.e., the site with intercept <span class="math inline">\(b_i = 0\)</span>, has success probability given by</p>
<p><span class="math display">\[ E[Disease Presense_{ik}|b_i = 0] = \frac{\exp(\sum_j \beta_j x_j + 0)}{1 + \exp(\sum_j \beta_j x_j + 0)} \]</span></p>
<p>which is what the authors have calculated and produced Fig 4. In other words, the authors have calculated the probability of disease for an “average” reef. The problem arises from the fact that, <span class="math inline">\(E[g(Y )] \neq g[E(Y)]\)</span> unless <span class="math inline">\(g\)</span> is linear, which is not the case for this model. The marginal population-average evolution is obtained from averaging over the random effects. The code they are using is</p>
<pre class="r"><code># GLMM, Baseline Disease levels for different growth forms, Asia Pacific --------
Normal.Disease.Growth = glmer(Disease ~ -1 + Growth2+(1|Reef_Name), 
                              data = Plastic[which(Plastic$Plastic==0),], 
                              family = &#39;binomial&#39;, 
                              control = glmerControl(optimizer =&quot;bobyqa&quot;))</code></pre>
<p>The following reproduces Figure 4(B) of the publication.</p>
<pre class="r"><code># PDF, Baseline disease levels by growth form -----------------------------
NormalDisease.by.Growth = data.frame(Tabular = rnorm(100000, mean = -3.1332, sd = .1549),
                                   Massive = rnorm(100000, mean = -3.8153, sd = .1095),
                                   Branching = rnorm(100000, mean = -3.5534, sd = .1103))
NormalDisease.by.Growth$Tabularbt = plogis(NormalDisease.by.Growth$Tabular)
NormalDisease.by.Growth$Massivebt = plogis(NormalDisease.by.Growth$Massive)
NormalDisease.by.Growth$Branchingbt = plogis(NormalDisease.by.Growth$Branching)
NormalDisease.by.Growth = gather(NormalDisease.by.Growth, Growth, Estimate, Tabularbt:Branchingbt)
#NormalDisease.by.Growth$Relative=NormalDisease.by.Growth$Estimate/plogis(-3.8153)
ggplot(aes(x=Estimate*100), data = NormalDisease.by.Growth) +
   geom_density(aes(y=..scaled..,fill = Growth)) +
   scale_x_continuous(limits = c(0, 10)) </code></pre>
<p><img src="/post/2018-03-26-plastic-waste-and-disease-on-coral-reefs_files/figure-html/plot-1.png" width="672" /></p>
<pre class="r"><code>#+
#   geom_rug(aes(color = Growth), #data=NormalDisease.by.Growth[seq(from=1,to=length(NormalDisease.by.Growth$Estimate),by=500),])</code></pre>
<p>As it is evident from the code they plot the fixed effects estimates with their standard errors. This plots ignores the uncertainty in …. it only takes into consideration the variation of the fixed coefficients <span class="math inline">\(\beta_j\)</span>.</p>
<p>To get an idea for the variability of the random effects I simulate random effects from the model and plot them. Points that are distinguishable from zero (i.e. the confidence band based on level does not cross the red line) are highlighted. We see great variation….</p>
<pre class="r"><code>library(merTools)
sim_rfs_Normal.Disease &lt;- REsim(Normal.Disease.Growth, n.sims = 200) 
plotREsim(sim_rfs_Normal.Disease)</code></pre>
<p><img src="/post/2018-03-26-plastic-waste-and-disease-on-coral-reefs_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>What the authors are effectively doing in Figure 4(B) (see density plot above) is presenting the results for reefs with <span class="math inline">\(b_i = 0\)</span> which correspond to the red horizontal line. Let’s see how figure (above) changes when we condition on more “extreme” reefs. I start with the 0.1 and 0.9 quantiles.</p>
<pre class="r"><code>quantile0.9 &lt;- REquantile(Normal.Disease.Growth, quantile = 0.9, groupFctr = &quot;Reef_Name&quot;)
which(sim_rfs_Normal.Disease$groupID == quantile0.9)</code></pre>
<pre><code>## [1] 44</code></pre>
<pre class="r"><code>quantile0.1 &lt;- REquantile(Normal.Disease.Growth, quantile = 0.1, groupFctr = &quot;Reef_Name&quot;)
which(sim_rfs_Normal.Disease$groupID == quantile0.1)</code></pre>
<pre><code>## [1] 22</code></pre>
<pre class="r"><code>NormalDisease.by.Growth_quantile0.9 = data.frame(Tabular = rnorm(100000, mean=-3.1332 + 1.495773,sd=.1549),
                                     Massive = rnorm(100000, mean=-3.8153 + 1.495773, sd = .1095),
                                     Branching=rnorm(100000, mean=-3.5534 + 1.495773, sd = .1103))
NormalDisease.by.Growth_quantile0.9$Tabularbt = plogis(NormalDisease.by.Growth_quantile0.9$Tabular)
NormalDisease.by.Growth_quantile0.9$Massivebt = plogis(NormalDisease.by.Growth_quantile0.9$Massive)
NormalDisease.by.Growth_quantile0.9$Branchingbt = plogis(NormalDisease.by.Growth_quantile0.9$Branching)
NormalDisease.by.Growth_quantile0.9 = gather(NormalDisease.by.Growth_quantile0.9, Growth, Estimate, Tabularbt:Branchingbt)
NormalDisease.by.Growth_quantile0.1 = data.frame(Tabular = rnorm(100000, mean=-3.1332 - 1.689569,sd=.1549),
                                                 Massive = rnorm(100000, mean=-3.8153 - 1.689569, sd = .1095),
                                                 Branching=rnorm(100000, mean=-3.5534 - 1.689569, sd = .1103))

NormalDisease.by.Growth_quantile0.1$Tabularbt = plogis(NormalDisease.by.Growth_quantile0.1$Tabular)
NormalDisease.by.Growth_quantile0.1$Massivebt = plogis(NormalDisease.by.Growth_quantile0.1$Massive)
NormalDisease.by.Growth_quantile0.1$Branchingbt = plogis(NormalDisease.by.Growth_quantile0.1$Branching)
NormalDisease.by.Growth_quantile0.1 = gather(NormalDisease.by.Growth_quantile0.1, Growth, Estimate, Tabularbt:Branchingbt)

NormalDisease.by.Growth$ID = &quot;average&quot;
NormalDisease.by.Growth_quantile0.1$ID = &quot;0.1quantile&quot;
NormalDisease.by.Growth_quantile0.9$ID = &quot;0.9quantile&quot;

overall &lt;- rbind(NormalDisease.by.Growth, NormalDisease.by.Growth_quantile0.1, NormalDisease.by.Growth_quantile0.9)
ggplot(aes(x = Estimate*100, col = ID), data = overall) +
   geom_density(aes(y = ..scaled.., fill = Growth), alpha = 0.9, size = 1.3) +
   scale_fill_brewer(palette = &quot;Spectral&quot;) + 
   #scale_fill_manual(values = c(&quot;#D55E00&quot;, &quot;#009E73&quot;, &quot;#0072B2&quot;)) + 
   scale_color_manual(values = c(&quot;#000000&quot;, &quot;dodgerblue&quot;, &quot;darkmagenta&quot;)) +
   scale_x_continuous(limits = c(0, 10)) + 
   ylab(&quot;&quot;)</code></pre>
<pre><code>## Warning: Removed 202905 rows containing non-finite values (stat_density).</code></pre>
<p><img src="/post/2018-03-26-plastic-waste-and-disease-on-coral-reefs_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>It is evident both the center and the variability of the distributions change depending whether we look an “average” coral reef (purple line), a reef towards the upper extreme (blue line) or the lower extreme (black line).</p>
<p>Conclusion the increase in disease likelihood with plastic debris depends also on the inherit characteristics of the reefs in addition to the morphology. For example, the likelihood of disease is between a braching reef at the lower extreme ( interpret the random effect) is and a tabular reef at the upper extreme (interpret the random effect) are very close.</p>
<p>In order to generate a proper prediction interval, a prediction must account for three sources of uncertainty in mixed models:</p>
<p>the residual (observation-level) variance, the uncertainty in the fixed coefficients, and the uncertainty in the variance parameters for the grouping factors.</p>
<p>FINAL ANALYSIS 1. TAKE Normal.Disease.Growth 2. REPRODUCE PLOTS 4(B) 3. PLOT RANDOM EFFECT ESTIMATES - MENTION UNCERTAINY 4. REDO PLOT 2 WITH 0.1 AND 0.9 QUANTILES 5. FORM PREDICTIVE INTERVALS</p>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-dryad_mp480">
<p>Lamb, JB, BL Willis, EA Fiorenza, CS Couch, R Howard, DN Rader, JD True, et al. 2018. “Data from: Plastic Waste Associated with Disease on Coral Reefs.” <em>Science</em>. Dryad Digital Repository. doi:<a href="https://doi.org/10.5061/dryad.mp480">10.5061/dryad.mp480</a>.</p>
</div>
<div id="ref-lamb2018plastic">
<p>Lamb, Joleah B, Bette L Willis, Evan A Fiorenza, Courtney S Couch, Robert Howard, Douglas N Rader, James D True, et al. 2018. “Plastic Waste Associated with Disease on Coral Reefs.” <em>Science</em> 359 (6374). American Association for the Advancement of Science: 460–62.</p>
</div>
</div>
</div>
